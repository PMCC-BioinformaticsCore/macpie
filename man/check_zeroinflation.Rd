% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/check_zeroinflation.R
\name{check_zeroinflation}
\alias{check_zeroinflation}
\title{Quick group-aware zero-inflation check (Negative Binomial baseline via edgeR)}
\usage{
check_zeroinflation(
  data = NULL,
  group_by = NULL,
  samples = NULL,
  batch = 1,
  cutoffs = c(0.1, 0.2)
)
}
\arguments{
\item{data}{Seurat object.}

\item{group_by}{Character, column in \code{data@meta.data} that defines groups
(default: \code{"combined_id"}).}

\item{samples}{Character vector of group labels/patterns to include. If
\code{NULL} or if none match, all groups in \code{group_by} are used.}

\item{batch}{Optional batch indicator; if length 1, an intercept-free design
is used with group dummies.}

\item{cutoffs}{Numeric vector of user-supply ZI thresholds for summary statistics}
}
\value{
A list with:
\itemize{
\item \code{gene_metrics_by_group}: long data frame (group × gene) with \code{p0_obs},
\code{p0_nb}, \code{ZI}, and counts.
\item \code{summary_by_group}: one row per group with medians and \% ZI thresholds,
plus observed/expected zero \strong{counts} for the group.
}
}
\description{
Computes a \strong{sample group-aware Zero-Inflation (ZI) index} for each gene using a
negative-binomial (NB) baseline fitted with \strong{edgeR}. For each group
(e.g., drug condition), the function:
\enumerate{
\item estimates gene-wise tagwise dispersions with edgeR (using all selected groups),
\item builds NB-expected zero probabilities from TMMwsp-scaled means, and
\item returns per-gene ZI (observed zeros minus NB-expected zeros) and
per-group summaries (e.g., \% genes with ZI > 0.05). ZI-cutoffs are user-defined.
}

This is intended as a \strong{fast screening diagnostic} to decide whether
standard NB GLM methods (edgeR/DESeq2) are adequate or whether a
zero-aware workflow (e.g., ZINB-WaVE) might be warranted.

This function \strong{relies on edgeR} to estimate dispersion. The current
implementation requires \strong{≥2 groups} in the design so that edgeR can
stabilize gene-wise dispersions across groups. If you only have a single
group and still want a design-aware baseline for expected zeros, fit a
Gamma–Poisson/NB GLM and compute the
expected zero probabilities from its fitted means and over-dispersion.
}
\note{
\itemize{
\item This is a \strong{screening} tool; it is not a replacement for fitting a full
GLM with your actual design. If strong covariates exist, a GLM baseline
(e.g., \code{glmGamPoi::glm_gp}) will yield more faithful expected-zero rates.
\item For single-group experiments, consider either adding a reference group or
switching to a GLM-based baseline that does not require multiple groups.
}
}
\examples{
data(mini_mac)
check_zeroinflation(mini_mac, group_by = "combined_id",
                     samples = c("DMSO_0","Staurosporine_10"))
}
