<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Scalable workflow for high-throughput transcriptomic profiling • macpie</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" sizes="any" href="favicon.ico">
<link rel="manifest" href="site.webmanifest">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Scalable workflow for high-throughput transcriptomic profiling">
<meta name="description" content="Macpie is an R package for the integrative analysis of transcriptomic screening data in the context of drug discovery and functional genomics. It enables users to systematically combine gene expression data with chemical descriptors, cell phenotypes, and pathway-level annotations to uncover biologically meaningful patterns and therapeutic insights.">
<meta property="og:description" content="Macpie is an R package for the integrative analysis of transcriptomic screening data in the context of drug discovery and functional genomics. It enables users to systematically combine gene expression data with chemical descriptors, cell phenotypes, and pathway-level annotations to uncover biologically meaningful patterns and therapeutic insights.">
<meta property="og:image" content="https://github.com/PMCC-BioinformaticsCore/macpie.git/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">macpie</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="index.html">Home</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="articles/macpie.html">Overview</a></li>
    <li><a class="dropdown-item" href="articles/quality_control.html">Quality control</a></li>
    <li><a class="dropdown-item" href="articles/transcriptional_analyses.html">Transcriptional analyses</a></li>
    <li><a class="dropdown-item" href="articles/high_throughput_screens.html">Compound screening</a></li>
    <li><a class="dropdown-item" href="articles/cross_platform_compatibility.html">Cross-platform compatibility</a></li>
    <li><a class="dropdown-item" href="articles/integration_across_modalities.html">Integration across modalities</a></li>
    <li><a class="dropdown-item" href="articles/macpie_bioc.html">Working with Bioconductor classes</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="https://github.com/PMCC-BioinformaticsCore/macpie.git"><span class="fa fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="macpie">macpie<a class="anchor" aria-label="anchor" href="#macpie"></a>
</h1>
</div>
<p><img src="reference/figures/logo.png" width="100" align="right"></p>
<!-- badges: start -->


<!-- badges: end -->
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>macpie is a R toolkit designed for researchers, originally with MAC-seq data in mind, but validated for general High-Throughput Transcriptomics (HTTr) data applications. Its primary aim is to deliver the latest tools for quality control (QC), visualization, and analysis.</p>
<p>For processing raw sequencing data into count matrices, please refer to our companion Nextflow workflow:<br><a href="https://github.com/PMCC-BioinformaticsCore/dinoflow" class="external-link"><strong>dinoflow: Nextflow workflow for MAC-seq</strong></a></p>
</div>
<div class="section level2">
<h2 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h2>
<p>Full documentation and step-by-step tutorials are available at:<br><a href="https://pmcc-bioinformaticscore.github.io/macpie/articles/macpie.html" class="external-link"><strong>macpie documentation site</strong></a></p>
<div class="section level3">
<h3 id="example-data">Example Data<a class="anchor" aria-label="anchor" href="#example-data"></a>
</h3>
<p>We provide both <strong>full</strong> and <strong>subset</strong> datasets for testing and exploration:</p>
<ul>
<li><p><strong>Full example dataset</strong> is hosted on Zenodo:<br><a href="https://doi.org/10.5281/zenodo.15778812" class="external-link uri">https://doi.org/10.5281/zenodo.15778812</a></p></li>
<li><p><strong>Quick-start subset <code>mini_mac</code></strong> is bundled with the package and can be loaded directly in R:</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mini_mac"</span>, package <span class="op">=</span> <span class="st">"macpie"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="requirements">Requirements<a class="anchor" aria-label="anchor" href="#requirements"></a>
</h2>
<ul>
<li>
<p><strong>R ≥ 4.3.3</strong></p>
<p>The package is developed on R 4.3.3, and installation (including all dependencies) has been tested on the latest R 4.5.0.</p>
</li>
</ul>
<div class="section level3">
<h3 id="installation-and-dependencies">Installation and dependencies<a class="anchor" aria-label="anchor" href="#installation-and-dependencies"></a>
</h3>
<p>All required R packages are automatically installed:</p>
<ul>
<li><p>via pak::pkg_install or devtools::install_github</p></li>
<li><p>or use our pre-built Docker image for a ready-to-use environment.</p></li>
</ul>
<div class="section level4">
<h4 id="installing-locally">Installing locally<a class="anchor" aria-label="anchor" href="#installing-locally"></a>
</h4>
<p>To install the development version of <code>macpie</code>, we recommend using <code>pak</code> - a fast package installer to install directly from GitHub. Make sure you have the <code>pak</code> package installed first.</p>
<div class="section level5">
<h5 id="configure-your-own-github-pat-optional">Configure your own GitHub PAT (optional)<a class="anchor" aria-label="anchor" href="#configure-your-own-github-pat-optional"></a>
</h5>
<p><code>pak</code> uses the GitHub API to resolve versions and fetch metadata—and unauthenticated requests are limited to 60 per hour. To avoid rate-limit errors, you can add your own Personal Access Token (PAT):</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install gitcreds if you haven’t already</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"gitcreds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># this will prompt you to paste in your PAT</span></span>
<span><span class="fu">gitcreds</span><span class="fu">::</span><span class="fu"><a href="https://gitcreds.r-lib.org/reference/gitcreds_get.html" class="external-link">gitcreds_set</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 1. Install pak (fast installer)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"pak"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"pak"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># 2. Make sure Bioconductor repos are set</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repos <span class="op">=</span> <span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/repositories.html" class="external-link">repositories</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3. Re-install macpie + exactly its Depends &amp; Imports via pak</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="https://pak.r-lib.org/reference/pkg_install.html" class="external-link">pkg_install</a></span><span class="op">(</span></span>
<span>  <span class="st">"PMCC-BioinformaticsCore/macpie"</span>,</span>
<span>  dependencies <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Depends"</span>, <span class="st">"Imports"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 4. Verify</span></span>
<span><span class="co"># Should load without error:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PMCC-BioinformaticsCore/macpie.git">macpie</a></span><span class="op">)</span></span></code></pre></div>
<p>Optially, you can also install the package by</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># First, install devtools if not already installed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make sure BiocManager is installed, and point your repos at both CRAN + Bioconductor</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"BiocManager"</span>, quietly<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>repos <span class="op">=</span> <span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/repositories.html" class="external-link">repositories</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://bioconductor.github.io/BiocManager/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"edgeR"</span>, <span class="st">"limma"</span>, <span class="st">"Biobase"</span>, <span class="st">"DESeq2"</span>, <span class="st">"RUVSeq"</span>,</span>
<span>  <span class="st">"EDASeq"</span>, <span class="st">"fgsea"</span>, <span class="st">"scran"</span>, <span class="st">"glmGamPoi"</span>,</span>
<span>  <span class="st">"BiocParallel"</span>, <span class="st">"SingleCellExperiment"</span>, <span class="st">"zinbwave"</span>,</span>
<span>  <span class="st">"SummarizedExperiment"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Install MOFA2 from its GitHub (it’s not on Bioconductor)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"bioFAM/MOFA2"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Finally, install macpie itself</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"PMCC-BioinformaticsCore/macpie"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="using-docker-image">Using Docker image<a class="anchor" aria-label="anchor" href="#using-docker-image"></a>
</h4>
<p>Have your docker desktop running, open a terminal, paste the docker pull command and install, depending on your platform.</p>
<ol style="list-style-type: decimal">
<li>Pull the Docker image</li>
</ol>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="ex">docker</span> pull <span class="at">--platform</span> linux/amd64 xliu81/macpie:v1.0.0</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Run the Docker container</li>
</ol>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="ex">docker</span> run <span class="at">--rm</span> <span class="at">-ti</span> <span class="dt">\</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="at">-e</span> PASSWORD=password <span class="dt">\</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="at">-p</span> 8787:8787 <span class="dt">\</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>  <span class="at">--platform</span> linux/amd64 <span class="dt">\</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="at">-v</span> /path/to/your/macpie/:/home/rstudio/macpie:z<span class="dt">\</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>  xliu81/macpie:v1.0.0</span></code></pre></div>
<ul>
<li><p>Replace /path/to/your/macpie/ with the absolute path to your local repo.</p></li>
<li>
<p>Copy and paste <a href="http://localhost:8787" class="external-link uri">http://localhost:8787</a> in your browser</p>
<ul>
<li><p>Username: rstudio</p></li>
<li><p>Password: password (or the one you set in the docker run command)</p></li>
</ul>
</li>
</ul>
<p>After logging in, you’ll find your local directory mounted under:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="ex">/home/rstudio/macpie/</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>In here we show using the <code>mini_mac</code> dataset for a quick start. From each vignette on our website, we only include a couple of functions in this quick start.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/PMCC-BioinformaticsCore/macpie.git">macpie</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load mini_mac, </span></span>
<span><span class="co"># mini_mac is a tidySeurat object with matched metadata</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"mini_mac"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Quality control</span></span>
<span><span class="co"># Filter by counts per sample group</span></span>
<span><span class="va">mini_mac</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/filter_genes_by_expression.html">filter_genes_by_expression</a></span><span class="op">(</span><span class="va">mini_mac</span>,</span>
<span>                                  group_by <span class="op">=</span> <span class="st">"combined_id"</span>,</span>
<span>                                  min_counts <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                                  min_samples <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># MDS plot</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot_mds.html">plot_mds</a></span><span class="op">(</span><span class="va">mini_mac</span>, group_by <span class="op">=</span> <span class="st">"Sample_type"</span>, label <span class="op">=</span> <span class="st">"combined_id"</span>, n_labels <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu">girafe</span><span class="op">(</span>ggobj <span class="op">=</span> <span class="va">p</span>, fonts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sans <span class="op">=</span> <span class="st">"sans"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Correction of the batch effect</span></span>
<span><span class="co"># First we will subset the data to look at control, DMSO samples only</span></span>
<span><span class="va">mini_mac_dmso</span> <span class="op">&lt;-</span> <span class="va">mini_mac</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Treatment_1</span> <span class="op">==</span> <span class="st">"DMSO"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run the RLE function</span></span>
<span><span class="fu"><a href="reference/plot_rle.html">plot_rle</a></span><span class="op">(</span><span class="va">mini_mac_dmso</span>, label_column <span class="op">=</span> <span class="st">"Row"</span>, normalisation <span class="op">=</span> <span class="st">"limma_voom"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># Transcriptional analysis</span></span>
<span><span class="co"># Single comparison</span></span>
<span><span class="co"># First perform the differential expression analysis</span></span>
<span><span class="va">treatment_samples</span> <span class="op">&lt;-</span> <span class="st">"Staurosporine_10"</span></span>
<span><span class="va">control_samples</span> <span class="op">&lt;-</span> <span class="st">"DMSO_0"</span></span>
<span><span class="va">top_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/compute_single_de.html">compute_single_de</a></span><span class="op">(</span><span class="va">mini_mac</span>, <span class="va">treatment_samples</span>, <span class="va">control_samples</span>, method <span class="op">=</span> <span class="st">"limma_voom"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">top_genes</span> <span class="op">&lt;-</span> <span class="va">top_table</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">p_value_adj</span> <span class="op">&lt;</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">gene</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># A volcano plot with very small number of genes, as it's a subset of the full dataset </span></span>
<span><span class="fu"><a href="reference/plot_volcano.html">plot_volcano</a></span><span class="op">(</span><span class="va">top_table</span>, max.overlaps <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Multiple comparisons</span></span>
<span><span class="co"># Filter out lower concentrations of compounds and untreated samples</span></span>
<span><span class="va">treatments</span> <span class="op">&lt;-</span> <span class="va">mini_mac</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Concentration_1</span> <span class="op">==</span> <span class="fl">10</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">combined_id</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"DMSO"</span>, <span class="va">combined_id</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">mini_mac</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/compute_multi_de.html">compute_multi_de</a></span><span class="op">(</span><span class="va">mini_mac</span>, <span class="va">treatments</span>, control_samples <span class="op">=</span> <span class="st">"DMSO_0"</span>, method <span class="op">=</span> <span class="st">"limma_voom"</span>, num_cores <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot shared differentially expressed genes</span></span>
<span><span class="fu"><a href="reference/plot_multi_de.html">plot_multi_de</a></span><span class="op">(</span><span class="va">mini_mac</span>, group_by <span class="op">=</span> <span class="st">"combined_id"</span>, value <span class="op">=</span> <span class="st">"log2FC"</span>, p_value_cutoff <span class="op">=</span> <span class="fl">0.01</span>, direction<span class="op">=</span><span class="st">"up"</span>, n_genes <span class="op">=</span> <span class="fl">5</span>, control <span class="op">=</span> <span class="st">"DMSO_0"</span>, by<span class="op">=</span><span class="st">"fc"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"macpie"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; To cite the macpie package in publications, please use:</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;  Bartonicek N, Liu X, Twomey L, Meier M, Lupat R, Craig S, Yoannidis D, Li J, Semple T,</span></span>
<span><span class="co">#&gt;  Simpson K, Li M, Ramm S (2025). “macpie: a scalable workflow for high-throughput</span></span>
<span><span class="co">#&gt;  transcriptomic profiling.” bioRxiv. doi:10.1101/2025.08.06.669002</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt; A BibTeX entry for LaTeX users is</span></span>
<span><span class="co">#&gt;</span></span>
<span><span class="co">#&gt;  @Article{,</span></span>
<span><span class="co">#&gt;    title   = {macpie: a scalable workflow for high-throughput transcriptomic profiling},</span></span>
<span><span class="co">#&gt;    author  = {Nenad Bartonicek and Xin Liu and Laura Twomey and Michelle Meier and Richard Lupat and Stuart Craig and David Yoannidis and Jason Li and Tim Semple and Kaylene J Simpson and Mark X Li and Susanne Ramm},</span></span>
<span><span class="co">#&gt;    journal = {bioRxiv},</span></span>
<span><span class="co">#&gt;    year    = {2025},</span></span>
<span><span class="co">#&gt;    doi     = {10.1101/2025.08.06.669002},</span></span>
<span><span class="co">#&gt;    url     = {https://www.biorxiv.org/content/10.1101/2025.08.06.669002v1}</span></span>
<span><span class="co">#&gt;  }</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/PMCC-BioinformaticsCore/macpie/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/PMCC-BioinformaticsCore/macpie/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing macpie</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Nenad Bartonicek <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2144-1887" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Xin Liu <br><small class="roles"> Author </small>   </li>
<li>Laura Twomey <br><small class="roles"> Author </small>   </li>
<li>Michelle Meier <br><small class="roles"> Author </small>   </li>
<li>Richard Lupat <br><small class="roles"> Author </small>   </li>
<li>Stuart Craig <br><small class="roles"> Author </small>   </li>
<li>David Yoannidis <br><small class="roles"> Author </small>   </li>
<li>Jason Li <br><small class="roles"> Author </small>   </li>
<li>Tim Semple <br><small class="roles"> Author </small>   </li>
<li>Kaylene J Simpson <br><small class="roles"> Author </small>   </li>
<li>Mark X Li <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-6222-4446" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
<li>Susanne Ramm <br><small class="roles"> Author </small>   </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/PMCC-BioinformaticsCore/macpie/actions/workflows/r-cmd-check.yaml" class="external-link"><img src="https://github.com/PMCC-BioinformaticsCore/macpie/actions/workflows/r-cmd-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://doi.org/10.5281/zenodo.15778812" class="external-link"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.15778812.svg" alt="DOI"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nenad Bartonicek, Xin Liu, Laura Twomey, Michelle Meier, Richard Lupat, Stuart Craig, David Yoannidis, Jason Li, Tim Semple, Kaylene J Simpson, Mark X Li, Susanne Ramm.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
